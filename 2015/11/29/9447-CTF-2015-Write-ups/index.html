<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>9447 CTF 2015 Write-ups | watch0ut Notebook</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">9447 CTF 2015 Write-ups</h1><a id="logo" href="/.">watch0ut Notebook</a><p class="description">echo &quot;TXIuQ2VuZytHcmVhdFlZWCtKYWNrUGFuPXdhdGNoMHV0LCBhIHRlYW0gb2YgMyBjb21wdXRlciBnZWVrcy4&quot; | base64 -d</p></div><div id="nav-menu"><a href="/"><i class="fa icon-home"> 首页</i></a><a href="/about/"><i class="fa icon-about"> 关于</i></a><a href="/atom.xml"><i class="fa icon-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">9447 CTF 2015 Write-ups</h1><div class="post-meta">Nov 29, 2015<span> | </span><span class="category"><a href="/categories/CTF/">CTF</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Reverse-engineering"><span class="toc-number">1.</span> <span class="toc-text">Reverse engineering</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#flag-finder-1pts"><span class="toc-number">1.1.</span> <span class="toc-text">flag finder (1pts)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#The-real-flag-finder-70pts"><span class="toc-number">1.2.</span> <span class="toc-text">The real flag finder (70pts)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-number">2.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sanutf8y-check-1pts"><span class="toc-number">2.1.</span> <span class="toc-text">sanutf8y_check (1pts)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#YWS-130pts"><span class="toc-number">2.2.</span> <span class="toc-text">YWS (130pts)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Misc"><span class="toc-number">3.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Get-help-10pts"><span class="toc-number">3.1.</span> <span class="toc-text">Get help (10pts)</span></a></li></ol></li></ol></div></div><div class="post-content"><h1 id="Reverse-engineering"><a href="#Reverse-engineering" class="headerlink" title="Reverse engineering"></a>Reverse engineering</h1><h2 id="flag-finder-1pts"><a href="#flag-finder-1pts" class="headerlink" title="flag finder (1pts)"></a>flag finder (1pts)</h2><p>I’ve forgotten my flag. I remember it has the format <code>9447{&lt;some string&gt;}</code>, but what could it be?</p>
<p>This task is sadly broken (it is too easy).</p>
<p>直接运行就得<code>flag</code>：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># ./flagfinder</div><div class="line">Try again</div><div class="line">9447&#123;C0ngr47ulaT1ons_p4l_buddy_y0Uv3_solved_the_H4LT1N6_prObL3M_n1c3_&#125; 1000024</div></pre></td></tr></table></figure></p>
<h2 id="The-real-flag-finder-70pts"><a href="#The-real-flag-finder-70pts" class="headerlink" title="The real flag finder (70pts)"></a>The <em>real</em> flag finder (70pts)</h2><p>I’ve forgotten my flag. I remember it has the format “9447{<some string="">}”, but what could it be?</some></p>
<p>Unfortunately the program no longer just prints the flag.</p>
<p>由上一题知道，整个循环在<code>1000024</code>此后结束，把整个过程用<code>Python</code>实现一下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">data = [0x32, 0x4A, 0xDB, 0xA5, 0xDB, 0x0D, 0x31, 0x54, 0xD4, 0x41, 0xF1, 0x89, 0x97, 0xE3, 0x4F, 0xD9,</div><div class="line">        0xF2, 0xED, 0x0B, 0xFF, 0xC9, 0xE3, 0x4B, 0xE1, 0x6A, 0x1A, 0x1B, 0xDA, 0x05, 0xAC, 0xE7, 0x82,</div><div class="line">        0x73, 0x20, 0xDF, 0x5B, 0x27, 0x5F, 0xA5, 0x95, 0xDC, 0xD5, 0xBD, 0x1A, 0xC7, 0xAB, 0x9A, 0x0E,</div><div class="line">        0x5E, 0x1B, 0xF5, 0x1D, 0x41, 0xDD, 0x43, 0xAC, 0x4D, 0x2A, 0x34, 0x2E, 0xBC, 0x7A, 0x6C, 0x37,</div><div class="line">        0x9C, 0x4C, 0x87, 0xCD, 0xE2, 0x4C]</div><div class="line">data_len = 70</div><div class="line">data_80 = 0x19660D</div><div class="line">data_84 = 0x3C6EF35F</div><div class="line">data_88 = 0x1571</div><div class="line"></div><div class="line">i = 0</div><div class="line">while True:</div><div class="line">    data_88 = data_88 * data_80 + data_84</div><div class="line">    c = (data_88 &amp; 0xFF00) &gt;&gt; 8</div><div class="line">    data_88 &amp;= 0xFFFFFFFFFFFFFFFF</div><div class="line">    data[i % data_len] = c ^ data[i % data_len]</div><div class="line">    i += 1</div><div class="line">    if i &gt; 1000024:</div><div class="line">        break</div><div class="line">print &apos;The flag is:&apos;, &apos;&apos;.join(chr(d) for d in data)</div></pre></td></tr></table></figure></p>
<blockquote>
<p>要考虑到data_88在C下会溢出，而在Python下就不会，后面计算会耗时很长，所以这里要做溢出处理。</p>
</blockquote>
<p>运行得到flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">9447&#123;C0ngr47ulaT1ons_p4l_buddy_y0Uv3_solved_the_re4l__H4LT1N6_prObL3M&#125;</div></pre></td></tr></table></figure></p>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="sanutf8y-check-1pts"><a href="#sanutf8y-check-1pts" class="headerlink" title="sanutf8y_check (1pts)"></a>sanutf8y_check (1pts)</h2><p>Visit <a href="http://sanutf8y-check-n2wisexx.9447.plumbing" target="_blank" rel="external">http://sanutf8y-check-n2wisexx.9447.plumbing</a> for the flag.</p>
<blockquote>
<p>Hint! The flag is in the format 9447{[a-zA-Z0-9_]*}</p>
</blockquote>
<p>访问链接得到：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">9447&#123;ΤҺiႽ_ⅰЅ_ԝ㏊t_Α_ﬂ‮...&#123;℮kⅠⅬ_skОOⅬ_ɡᴀ</div></pre></td></tr></table></figure></p>
<p>把内容转换成字母加数字，可得flag：<br><code>9447{ThiS_iS_what_A_flAg_LOOks_LIke}</code></p>
<h2 id="YWS-130pts"><a href="#YWS-130pts" class="headerlink" title="YWS (130pts)"></a>YWS (130pts)</h2><p>My friend wrote a cool web server. I’m sure he’s stored some great doxxxs on the website. Can you take a look and report back any interesting things you find?</p>
<p>The web page is at <a href="http://yws-fsiqc922.9447.plumbing" target="_blank" rel="external">http://yws-fsiqc922.9447.plumbing</a></p>
<p>尝试<code>robots.txt</code>文件，内容如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">User-agnet: *</div><div class="line">Disallow: /</div><div class="line">Disallow: /..</div><div class="line">Disallow: .</div><div class="line">Disallow: ..</div><div class="line">Disallow: /work</div><div class="line">Disallow: /imegas/</div><div class="line">Allow: /sounds/pljesus.wav</div></pre></td></tr></table></figure></p>
<p>既然不让搜索引擎看这些目录，那我们就来看看，访问<code>/..</code>目录得到：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">&lt;html&gt;</div><div class="line">  &lt;head&gt;</div><div class="line">    &lt;title&gt;Directory listing for /..&lt;/title&gt;</div><div class="line">  &lt;/head&gt;</div><div class="line">  &lt;body&gt;</div><div class="line">    &lt;h2&gt;Directory listing for /..&lt;/h2&gt;</div><div class="line">    &lt;hr&gt;</div><div class="line">    &lt;ul&gt;</div><div class="line">      &lt;li&gt;</div><div class="line">        &lt;a href=&quot;/../9447&#123;D1rect0ries_ARe_h4rd&#125;&quot;&gt;9447&#123;D1rect0ries_ARe_h4rd&#125;&lt;/a&gt;</div><div class="line">        &lt;li&gt;</div><div class="line">          &lt;a href=&quot;/../.&quot;&gt;.&lt;/a&gt;</div><div class="line">          &lt;li&gt;</div><div class="line">            &lt;a href=&quot;/../..&quot;&gt;..&lt;/a&gt;</div><div class="line">            &lt;li&gt;</div><div class="line">              &lt;a href=&quot;/../gws&quot;&gt;gws&lt;/a&gt;</div><div class="line">              &lt;li&gt;</div><div class="line">                &lt;a href=&quot;/../files&quot;&gt;files&lt;/a&gt;</div><div class="line">              &lt;/ul&gt;</div><div class="line">              &lt;hr&gt;</div><div class="line">            &lt;/body&gt;</div><div class="line">          &lt;/html&gt;</div></pre></td></tr></table></figure></p>
<p>flag：<code>9447{D1rect0ries_ARe_h4rd}</code></p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Get-help-10pts"><a href="#Get-help-10pts" class="headerlink" title="Get help (10pts)"></a>Get help (10pts)</h2><p>Where would you go to get help?</p>
<p>访问提供的<code>irc</code>，公告如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">#9447CTF: Signups for 9447CTF 2015 open at https://9447.plumbing/ - welcome! 9447&#123;Ask_for_help_here&#125; | Hint released for sanutf8y_check | New exploitation released - RedOS</div></pre></td></tr></table></figure></p>
<p>flag：<code>9447{Ask_for_help_here}</code></p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://blog.watch0ut.com/2015/11/29/9447-CTF-2015-Write-ups/" data-id="ciyjsu77g0001f4mpe5566bv9" class="article-share-link">分享到</a><div class="tags"><a href="/tags/CTF/">CTF</a></div><div class="post-nav"><a href="/2015/12/08/HCTF-2015-Write-ups/" class="pre">HCTF 2015 Write-ups</a><a href="/2014/11/10/HCTF-2014-Write-ups/" class="next">HCTF 2014 Write-ups</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="search" name="word" maxlength="20" placeholder="Search"/><input type="hidden" name="si" value="http://blog.watch0ut.com"/><input name="tn" type="hidden" value="bds"/><input name="cl" type="hidden" value="3"/><input name="ct" type="hidden" value="2097152"/><input name="s" type="hidden" value="on"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF/">CTF</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/CTF/" style="font-size: 15px;">CTF</a> <a href="/tags/Web/" style="font-size: 15px;">Web</a> <a href="/tags/Misc/" style="font-size: 15px;">Misc</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2015/12/08/HCTF-2015-Write-ups/">HCTF 2015 Write-ups</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/11/29/9447-CTF-2015-Write-ups/">9447 CTF 2015 Write-ups</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/11/10/HCTF-2014-Write-ups/">HCTF 2014 Write-ups</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/10/08/XD-CTF-2014-Write-ups/">XD CTF 2014 Write-ups</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/09/29/ISG-CTF-2014-Write-up-SQLMAP-Up-to-Date/">ISG CTF 2014 Write-up (SQLMAP, Up-to-Date)</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/09/29/ISG-CTF-2014-Write-up-Out-of-Space-X-Area/">ISG CTF 2014 Write-up (Out of Space, X-Area)</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/09/29/ISG-CTF-2014-Write-up-Smile-Chopper-Cryptobaby-GIF/">ISG CTF 2014 Write-up (Smile, Chopper, Cryptobaby, GIF)</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/08/26/HITCON-CTF-2014-Tarmful-Write-up/">HITCON CTF 2014 Tarmful Write-up</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/08/22/HITCON-CTF-2014-DIAGCGI-Write-up/">HITCON CTF 2014 DIAGCGI Write-up</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/08/20/HITCON-CTF-2014-PY4H4SHER-Write-up/">HITCON CTF 2014 PY4H4SHER Write-up</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">watch0ut Notebook.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>