<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>HCTF 2014 Write-ups | watch0ut Notebook</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">HCTF 2014 Write-ups</h1><a id="logo" href="/.">watch0ut Notebook</a><p class="description">echo &quot;TXIuQ2VuZytHcmVhdFlZWCtKYWNrUGFuPXdhdGNoMHV0LCBhIHRlYW0gb2YgMyBjb21wdXRlciBnZWVrcy4&quot; | base64 -d</p></div><div id="nav-menu"><a href="/"><i class="fa icon-home"> 首页</i></a><a href="/about/"><i class="fa icon-about"> 关于</i></a><a href="/atom.xml"><i class="fa icon-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">HCTF 2014 Write-ups</h1><div class="post-meta">Nov 10, 2014<span> | </span><span class="category"><a href="/categories/CTF/">CTF</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#丘比龙的最爱"><span class="toc-number">1.</span> <span class="toc-text">丘比龙的最爱</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#nvshen"><span class="toc-number">2.</span> <span class="toc-text">nvshen</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#babyCrack"><span class="toc-number">3.</span> <span class="toc-text">babyCrack</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GIFT"><span class="toc-number">4.</span> <span class="toc-text">GIFT</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#babyCrack2"><span class="toc-number">5.</span> <span class="toc-text">babyCrack2</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Entry"><span class="toc-number">6.</span> <span class="toc-text">Entry</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FIND"><span class="toc-number">7.</span> <span class="toc-text">FIND</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NormalFile"><span class="toc-number">8.</span> <span class="toc-text">NormalFile</span></a></li></ol></div></div><div class="post-content"><h1 id="丘比龙的最爱"><a href="#丘比龙的最爱" class="headerlink" title="丘比龙的最爱"></a>丘比龙的最爱</h1><p>丘比龙的最爱传说，丘比龙是丘比特的弟弟，丘比龙是一只小爱神，虽然有两只翅膀，但因为吃多了，导致身体太胖，所以飞不起来~那么问题来了?!丘比龙吃什么食物吃多了变胖了<br>没什么好说的，就是<code>甜甜圈</code>。</p>
<h1 id="nvshen"><a href="#nvshen" class="headerlink" title="nvshen"></a>nvshen</h1><p>猫流大大发现一个女神，你能告诉我女神的名字么（名字即是flag）<br><a href="http://107.189.158.112/0aab9b20410fdd880c53922048023266/nvshen.zip" target="_blank" rel="external">http://107.189.158.112/0aab9b20410fdd880c53922048023266/nvshen.zip</a></p>
<p>下载的文件中有个txt文件，是<code>Base64</code>编码的，初步解码是判断png图片，将编码内容嵌入<code>HTML</code>中，显示一张图片：<br><img src="/images/nvshen.png" alt="女神"><br>google一下，得到女神的名字：<code>爱新觉罗启星</code>。</p>
<h1 id="babyCrack"><a href="#babyCrack" class="headerlink" title="babyCrack"></a>babyCrack</h1><p>107.189.158.112/d55757a7ccf958399789e18e1d8199de/babyCrack.zip</p>
<p>解压后是是一个<code>.Net</code>的<code>exe</code>，直接用<code>.Net Reflector</code>反编译：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">private void button1_Click(object sender, EventArgs e)</div><div class="line">&#123;</div><div class="line">    bool flag = false;</div><div class="line">    Config.user = this.textBox1.Text;</div><div class="line">    string user = Config.user;</div><div class="line">    string str2 = &quot;hctf&#123;bABy_CtsvlmE_!&#125;&quot;;</div><div class="line">    if (str2.CompareTo(user) == 0)</div><div class="line">    &#123;</div><div class="line">        flag = true;</div><div class="line">    &#125;</div><div class="line">    if (flag)</div><div class="line">    &#123;</div><div class="line">        MessageBox.Show(&quot;good !!!&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>得到flag：<code>hctf{bABy_CtsvlmE_!}</code>。</p>
<h1 id="GIFT"><a href="#GIFT" class="headerlink" title="GIFT"></a>GIFT</h1><p>主办方准备了一个礼物! <a href="http://121.40.86.166:39099" target="_blank" rel="external">http://121.40.86.166:39099</a></p>
<p>访问后，查看源码，提示有<code>index.php.bak</code>，下载后查看源码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">    $flag=&apos;xxx&apos;;</div><div class="line">    extract($_GET);</div><div class="line">    if(isset($gift))&#123;</div><div class="line">        $content=trim(file_get_contents($flag));</div><div class="line">        if($gift==$content)&#123;</div><div class="line">            echo&apos;hctf&#123;...&#125;&apos;;</div><div class="line">        &#125;else&#123;</div><div class="line">            echo&apos;Oh..&apos;;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">?&gt;</div></pre></td></tr></table></figure></p>
<p>根据源码，用<code>get</code>参数将<code>flag</code>的值覆盖，使其是一个 不存在的文件名，然后将<code>gift</code>的内容赋值为空，构造<code>url</code>如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://121.40.86.166:39099/?gift=&amp;flag=aaaaa</div></pre></td></tr></table></figure></p>
<p>得到flag：<code>hctf{Awe3ome_Ex7ract!!!}</code>。</p>
<h1 id="babyCrack2"><a href="#babyCrack2" class="headerlink" title="babyCrack2"></a>babyCrack2</h1><p>107.189.158.112/e81cbc49ae92b00d3b55430f21cbe2fe/babyCrack2.zip</p>
<p>IDA反汇编，查看字符串得到flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">idug|3`5ut`CCbZ`DusnF`34~</div></pre></td></tr></table></figure></p>
<h1 id="Entry"><a href="#Entry" class="headerlink" title="Entry"></a>Entry</h1><p>57R9S980RNOS49973S757PQO9S80Q36P 听说丘比龙一口气能吃”13”个甜甜圈呢!</p>
<p>32位，感觉想MD5，尝试如下对应：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">NOPQRS</div><div class="line">ABCDEF</div></pre></td></tr></table></figure></p>
<p>得到<code>57E9F980EABF49973F757CDB9F80D36C</code>，然后破解MD5，得到<code>Qoobee</code></p>
<h1 id="FIND"><a href="#FIND" class="headerlink" title="FIND"></a>FIND</h1><p>Find what？ <a href="http://107.189.158.112/f60a0a6ffd7c297964a718dc21546975/stego_final.png" target="_blank" rel="external">http://107.189.158.112/f60a0a6ffd7c297964a718dc21546975/stego_final.png</a></p>
<p>用神器<code>stego solve</code>分析，得到二维码，直接提取的二维码，我怎么扫都扫不出来，后来Great YYX助攻，用PS处理了下就可以了：<br><img src="/images/FIND-qrcode.jpg" alt="二维码"><br>扫描即可得到flag：<code>flag{hctf_3xF$235#\x5e3}</code></p>
<h1 id="NormalFile"><a href="#NormalFile" class="headerlink" title="NormalFile"></a>NormalFile</h1><p>你能找到其中的深意么？ <a href="http://107.189.158.112/fdd9df21d6c5d65fe519f69f8424d65b/NormalFile.jpg" target="_blank" rel="external">http://107.189.158.112/fdd9df21d6c5d65fe519f69f8424d65b/NormalFile.jpg</a></p>
<p>下载图片，提取出一个zip文件，解压，又有一张图片，又提取出一个apk，反编译apk，分析flag生成过程，一开始没看到half那个字符串，以为答案有多个，随便生成一个，提交发现不对，后来在string.xml找到half才确定，自己用Python实现：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">num_xor = [112, 83, 93, 112, 28, 0, 87, 91]</div><div class="line">    </div><div class="line">half = &apos;401!n++p&apos;</div><div class="line"></div><div class="line"></div><div class="line">def main():</div><div class="line">    last = &apos;&apos;</div><div class="line">    for i in xrange(0, 8):</div><div class="line">        last += chr(ord(half[i]) ^ num_xor[i])</div><div class="line">    flag = &apos;hctf&#123;&apos; + half[0] + half[4] + last[0] + last[4] + half[1] + half[2] \</div><div class="line">           + last[1] + last[2] + half[2] + half[1] + last[2] + last[6] + half[3] \</div><div class="line">           + half[7] + last[3] + half[7] + &apos;&#125;&apos;</div><div class="line">    print flag</div></pre></td></tr></table></figure></p>
<p>运行得到flag：<code>hctf{4nDr01cl10l|!pQp}</code>。</p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://blog.watch0ut.com/2014/11/10/HCTF-2014-Write-ups/" data-id="ciyjrumj80004vfmp7uxt7yf3" class="article-share-link">分享到</a><div class="tags"><a href="/tags/CTF/">CTF</a></div><div class="post-nav"><a href="/2015/11/29/9447-CTF-2015-Write-ups/" class="pre">9447 CTF 2015 Write-ups</a><a href="/2014/10/08/XD-CTF-2014-Write-ups/" class="next">XD CTF 2014 Write-ups</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="search" name="word" maxlength="20" placeholder="Search"/><input type="hidden" name="si" value="http://blog.watch0ut.com"/><input name="tn" type="hidden" value="bds"/><input name="cl" type="hidden" value="3"/><input name="ct" type="hidden" value="2097152"/><input name="s" type="hidden" value="on"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF/">CTF</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/CTF/" style="font-size: 15px;">CTF</a> <a href="/tags/Web/" style="font-size: 15px;">Web</a> <a href="/tags/Misc/" style="font-size: 15px;">Misc</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2015/12/08/HCTF-2015-Write-ups/">HCTF 2015 Write-ups</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/11/29/9447-CTF-2015-Write-ups/">9447 CTF 2015 Write-ups</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/11/10/HCTF-2014-Write-ups/">HCTF 2014 Write-ups</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/10/08/XD-CTF-2014-Write-ups/">XD CTF 2014 Write-ups</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/09/29/ISG-CTF-2014-Write-up-SQLMAP-Up-to-Date/">ISG CTF 2014 Write-up (SQLMAP, Up-to-Date)</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/09/29/ISG-CTF-2014-Write-up-Out-of-Space-X-Area/">ISG CTF 2014 Write-up (Out of Space, X-Area)</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/09/29/ISG-CTF-2014-Write-up-Smile-Chopper-Cryptobaby-GIF/">ISG CTF 2014 Write-up (Smile, Chopper, Cryptobaby, GIF)</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/08/26/HITCON-CTF-2014-Tarmful-Write-up/">HITCON CTF 2014 Tarmful Write-up</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/08/22/HITCON-CTF-2014-DIAGCGI-Write-up/">HITCON CTF 2014 DIAGCGI Write-up</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/08/20/HITCON-CTF-2014-PY4H4SHER-Write-up/">HITCON CTF 2014 PY4H4SHER Write-up</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">watch0ut Notebook.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>